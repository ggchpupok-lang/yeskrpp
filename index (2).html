<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yes KRP Trading - –¢–∞–ø–∞–ª–∫–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-primary: #121212;
            --bg-secondary: #1e1e1e;
            --bg-tertiary: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --accent: #bb86fc;
            --positive: #4caf50;
            --negative: #f44336;
            --border: #333333;
            --coin: #ffd700;
            --apple: #ff6b6b;
            --bear: #8d6e63;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            padding: 16px;
            max-width: 100%;
            overflow-x: hidden;
            padding-bottom: 70px; /* –î–ª—è –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            font-size: 20px;
            font-weight: bold;
            color: var(--accent);
        }

        .currency-display {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            gap: 10px;
        }

        .currency-item {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            padding: 12px;
            flex: 1;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .currency-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .coin { color: var(--coin); }
        .apple { color: var(--apple); }
        .bear { color: var(--bear); }

        .currency-amount {
            font-size: 18px;
            font-weight: bold;
        }

        .tap-area {
            background-color: var(--bg-secondary);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .exchange-building {
            font-size: 80px;
            cursor: pointer;
            transition: transform 0.1s;
            user-select: none;
        }

        .exchange-building:active {
            transform: scale(0.95);
        }

        .tap-text {
            position: absolute;
            color: var(--coin);
            font-weight: bold;
            pointer-events: none;
            animation: floatUp 1s forwards;
            opacity: 0;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateY(-50px);
                opacity: 0;
            }
        }

        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
        }

        .tab {
            padding: 10px 16px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
            border-bottom: 2px solid transparent;
            white-space: nowrap;
        }

        .tab.active {
            opacity: 1;
            border-bottom: 2px solid var(--accent);
        }

        .upgrades-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .upgrade-card {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            transition: transform 0.2s, background-color 0.2s;
        }

        .upgrade-card:active {
            transform: scale(0.98);
            background-color: var(--bg-tertiary);
        }

        .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .upgrade-icon {
            font-size: 24px;
            margin-right: 10px;
        }

        .upgrade-title {
            font-weight: bold;
            font-size: 16px;
        }

        .upgrade-description {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .upgrade-cost {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cost-item {
            display: flex;
            align-items: center;
            margin-right: 10px;
        }

        .cost-amount {
            margin-left: 5px;
        }

        .tasks-list {
            display: grid;
            gap: 12px;
        }

        .task-card {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            position: relative;
        }

        .task-progress {
            height: 5px;
            background-color: var(--bg-tertiary);
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }

        .task-progress-bar {
            height: 100%;
            background-color: var(--accent);
            border-radius: 5px;
            transition: width 0.3s;
        }

        .task-reward {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .task-claim-btn {
            background-color: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: opacity 0.2s;
        }

        .task-claim-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .section-title {
            font-size: 18px;
            margin: 20px 0 15px;
            color: var(--text-primary);
        }

        .back-button {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            color: var(--accent);
            cursor: pointer;
        }

        .back-button svg {
            margin-right: 8px;
        }

        .loader {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .loader-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--bg-tertiary);
            border-top: 4px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--bg-secondary);
            display: flex;
            justify-content: space-around;
            padding: 10px;
            border-top: 1px solid var(--border);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px 10px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .nav-item.active {
            opacity: 1;
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 12px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä—ã —Å –º–∏—à–∫–æ–π */
        .bear-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }

        .bear-display {
            font-size: 100px;
            margin-bottom: 15px;
            transition: transform 0.3s;
        }

        .bear-info {
            text-align: center;
            margin-bottom: 15px;
        }

        .bear-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .bear-age {
            color: var(--text-secondary);
        }

        .bear-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
            width: 100%;
        }

        .stat-item {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            margin-top: 5px;
        }

        .bear-shop {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
            width: 100%;
        }

        .shop-item {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .shop-item:active {
            transform: scale(0.98);
        }

        .shop-item-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .shop-item-cost {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 8px;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –º–∏—à–∫–∏ */
        @keyframes bearHappy {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .bear-happy {
            animation: bearHappy 1s ease-in-out;
        }

        @keyframes bearEat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .bear-eating {
            animation: bearEat 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">Yes KRP –¢–∞–ø–∞–ª–∫–∞</div>
            <div id="refresh-btn" style="cursor: pointer;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4C7.58 4 4.01 7.58 4.01 12C4.01 16.42 7.58 20 12 20C15.73 20 18.84 17.45 19.73 14H17.65C16.83 16.33 14.61 18 12 18C8.69 18 6 15.31 6 12C6 8.69 8.69 6 12 6C13.66 6 15.14 6.69 16.22 7.78L13 11H20V4L17.65 6.35Z" fill="white"/>
                </svg>
            </div>
        </div>

        <div class="currency-display">
            <div class="currency-item">
                <div class="currency-icon coin">ü™ô</div>
                <div class="currency-amount" id="coins-count">0</div>
            </div>
            <div class="currency-item">
                <div class="currency-icon apple">üçé</div>
                <div class="currency-amount" id="apples-count">0</div>
            </div>
            <div class="currency-item">
                <div class="currency-icon bear">üß∏</div>
                <div class="currency-amount" id="bears-count">0</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="tap">–¢–∞–ø–∞–ª–∫–∞</div>
            <div class="tab" data-tab="upgrades">–£–ª—É—á—à–µ–Ω–∏—è</div>
            <div class="tab" data-tab="tasks">–ó–∞–¥–∞–Ω–∏—è</div>
            <div class="tab" data-tab="stocks">–ê–∫—Ü–∏–∏</div>
            <div class="tab" data-tab="portfolio">–ü–æ—Ä—Ç—Ñ–µ–ª—å</div>
            <div class="tab" data-tab="bear">–ú–æ–π –º–∏—à–∫–∞</div>
        </div>

        <div id="tap-view">
            <div class="tap-area">
                <div class="exchange-building" id="exchange-building">üè¶</div>
            </div>
            
            <div class="section-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
            <div class="currency-item">
                <div>–í—Å–µ–≥–æ —Ç–∞–ø–æ–≤: <span id="total-taps">0</span></div>
                <div>–¢–∞–ø–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É: <span id="taps-per-second">0</span></div>
                <div>–£—Ä–æ–≤–µ–Ω—å –±–∏—Ä–∂–∏: <span id="exchange-level">1</span></div>
            </div>
        </div>

        <div id="upgrades-view" class="hidden">
            <div class="section-title">–£–ª—É—á—à–µ–Ω–∏—è –±–∏—Ä–∂–∏</div>
            <div class="upgrades-grid" id="upgrades-container">
                <!-- –£–ª—É—á—à–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>

        <div id="tasks-view" class="hidden">
            <div class="section-title">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</div>
            <div class="tasks-list" id="tasks-container">
                <!-- –ó–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>

        <div id="stocks-view" class="hidden">
            <div class="section-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ –∞–∫—Ü–∏–∏</div>
            <div class="stock-list" id="stock-list">
                <div class="loader">
                    <div class="loader-spinner"></div>
                </div>
            </div>
        </div>

        <div id="portfolio-view" class="hidden">
            <div class="section-title">–í–∞—à –ø–æ—Ä—Ç—Ñ–µ–ª—å</div>
            <div id="portfolio-content">
                <div class="loader">
                    <div class="loader-spinner"></div>
                </div>
            </div>
        </div>

        <div id="bear-view" class="hidden">
            <div class="bear-container">
                <div class="bear-display" id="bear-display">üß∏</div>
                <div class="bear-info">
                    <div class="bear-name" id="bear-name">–ú–æ–π –º–∏—à–∫–∞</div>
                    <div class="bear-age" id="bear-age">–í–æ–∑—Ä–∞—Å—Ç: 0 –ª–µ—Ç</div>
                </div>
                
                <div class="bear-stats">
                    <div class="stat-item">
                        <div>–°—ã—Ç–æ—Å—Ç—å</div>
                        <div class="stat-value" id="bear-hunger">100%</div>
                    </div>
                    <div class="stat-item">
                        <div>–°—á–∞—Å—Ç—å–µ</div>
                        <div class="stat-value" id="bear-happiness">100%</div>
                    </div>
                    <div class="stat-item">
                        <div>–ó–¥–æ—Ä–æ–≤—å–µ</div>
                        <div class="stat-value" id="bear-health">100%</div>
                    </div>
                    <div class="stat-item">
                        <div>–≠–Ω–µ—Ä–≥–∏—è</div>
                        <div class="stat-value" id="bear-energy">100%</div>
                    </div>
                </div>
                
                <div class="section-title">–ú–∞–≥–∞–∑–∏–Ω –¥–ª—è –º–∏—à–∫–∏</div>
                <div class="bear-shop" id="bear-shop">
                    <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>
        </div>

        <div id="stock-detail-view" class="hidden">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞–∫—Ü–∏–∏ -->
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="bottom-nav">
        <div class="nav-item active" data-view="tap">
            <div class="nav-icon">üéÆ</div>
            <div class="nav-label">–ò–≥—Ä–∞—Ç—å</div>
        </div>
        <div class="nav-item" data-view="stocks">
            <div class="nav-icon">üìà</div>
            <div class="nav-label">–ê–∫—Ü–∏–∏</div>
        </div>
        <div class="nav-item" data-view="portfolio">
            <div class="nav-icon">üí∞</div>
            <div class="nav-label">–ö–æ—à–µ–ª–µ–∫</div>
        </div>
        <div class="nav-item" data-view="bear">
            <div class="nav-icon">üß∏</div>
            <div class="nav-label">–ú–æ–π –º–∏—à–∫–∞</div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–ø–∞–ª–∫–∏
        let gameState = {
            coins: 1000,
            apples: 50,
            bears: 5,
            totalTaps: 0,
            exchangeLevel: 1,
            tapsPerSecond: 0,
            upgrades: [],
            tasks: [],
            lastSave: Date.now(),
            // –î–∞–Ω–Ω—ã–µ –¥–ª—è –º–∏—à–∫–∏
            bear: {
                name: "–ú–æ–π –º–∏—à–∫–∞",
                age: 0, // –≤ –≥–æ–¥–∞—Ö
                hunger: 100,
                happiness: 100,
                health: 100,
                energy: 100,
                appearance: "baby", // baby, toddler, child, teen, adult
                lastUpdate: Date.now()
            }
        };

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É–ª—É—á—à–µ–Ω–∏—è
        const upgradesData = [
            {
                id: 1,
                name: "–£–ª—É—á—à–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å",
                description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç –∑–∞ —Ç–∞–ø –Ω–∞ 1",
                icon: "üíª",
                cost: { coins: 10, apples: 0, bears: 0 },
                effect: { tapValue: 1 },
                owned: 0
            },
            {
                id: 2,
                name: "–ë—ã—Å—Ç—Ä—ã–µ —Å–µ—Ä–≤–µ—Ä—ã",
                description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 0.5 –º–æ–Ω–µ—Ç –≤ —Å–µ–∫—É–Ω–¥—É",
                icon: "üöÄ",
                cost: { coins: 50, apples: 0, bears: 0 },
                effect: { passiveIncome: 0.5 },
                owned: 0
            },
            {
                id: 3,
                name: "–†–µ–∫–ª–∞–º–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è",
                description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —à–∞–Ω—Å –ø–æ–ª—É—á–µ–Ω–∏—è —è–±–ª–æ–∫",
                icon: "üì¢",
                cost: { coins: 100, apples: 1, bears: 0 },
                effect: { appleChance: 0.1 },
                owned: 0
            },
            {
                id: 4,
                name: "–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
                description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 1 –º–æ–Ω–µ—Ç—É –≤ —Å–µ–∫—É–Ω–¥—É",
                icon: "üì±",
                cost: { coins: 200, apples: 2, bears: 0 },
                effect: { passiveIncome: 1 },
                owned: 0
            },
            {
                id: 5,
                name: "–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–¥–µ–ª",
                description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–æ—Ö–æ–¥ –æ—Ç –∞–∫—Ü–∏–π –Ω–∞ 5%",
                icon: "üìä",
                cost: { coins: 500, apples: 5, bears: 0 },
                effect: { stockIncome: 0.05 },
                owned: 0
            },
            {
                id: 6,
                name: "–ò–ò-—Ç—Ä–µ–π–¥–µ—Ä",
                description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 5 –º–æ–Ω–µ—Ç –≤ —Å–µ–∫—É–Ω–¥—É",
                icon: "ü§ñ",
                cost: { coins: 1000, apples: 10, bears: 1 },
                effect: { passiveIncome: 5 },
                owned: 0
            }
        ];

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–∞–¥–∞–Ω–∏—è
        const tasksData = [
            {
                id: 1,
                name: "–ù–æ–≤–∏—á–æ–∫ —Ç–∞–ø–µ—Ä–∞",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 100 —Ç–∞–ø–æ–≤",
                goal: 100,
                progress: 0,
                reward: { coins: 10, apples: 0, bears: 0 },
                completed: false,
                claimed: false
            },
            {
                id: 2,
                name: "–°–±–æ—Ä —É—Ä–æ–∂–∞—è",
                description: "–ó–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ 10 —è–±–ª–æ–∫",
                goal: 10,
                progress: 0,
                reward: { coins: 50, apples: 1, bears: 0 },
                completed: false,
                claimed: false
            },
            {
                id: 3,
                name: "–í–µ—Ç–µ—Ä–∞–Ω —Ç–∞–ø–æ–≤",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 10,000 —Ç–∞–ø–æ–≤",
                goal: 10000,
                progress: 0,
                reward: { coins: 500, apples: 5, bears: 1 },
                completed: false,
                claimed: false
            },
            {
                id: 4,
                name: "–£–ª—É—á—à–∞—Ç–µ–ª—å",
                description: "–ö—É–ø–∏—Ç–µ 5 —É–ª—É—á—à–µ–Ω–∏–π",
                goal: 5,
                progress: 0,
                reward: { coins: 200, apples: 3, bears: 1 },
                completed: false,
                claimed: false
            },
            {
                id: 5,
                name: "–ò–Ω–≤–µ—Å—Ç–æ—Ä",
                description: "–ó–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ 1000 –º–æ–Ω–µ—Ç —Å –∞–∫—Ü–∏–π",
                goal: 1000,
                progress: 0,
                reward: { coins: 1000, apples: 10, bears: 2 },
                completed: false,
                claimed: false
            }
        ];

        // –¢–æ–≤–∞—Ä—ã –¥–ª—è –º–∏—à–∫–∏
        const bearShopItems = [
            {
                id: 1,
                name: "–ï–¥–∞",
                description: "–í–∫—É—Å–Ω–∞—è –µ–¥–∞ –¥–ª—è –º–∏—à–∫–∏",
                icon: "üçé",
                cost: { coins: 0, apples: 1, bears: 0 },
                effect: { hunger: 20, happiness: 5 }
            },
            {
                id: 2,
                name: "–ò–≥—Ä—É—à–∫–∞",
                description: "–ù–æ–≤–∞—è –∏–≥—Ä—É—à–∫–∞ –¥–ª—è —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π",
                icon: "üé≤",
                cost: { coins: 10, apples: 0, bears: 0 },
                effect: { happiness: 15, energy: -5 }
            },
            {
                id: 3,
                name: "–õ–µ–∫–∞—Ä—Å—Ç–≤–æ",
                description: "–õ–µ—á–µ–Ω–∏–µ –¥–ª—è –º–∏—à–∫–∏",
                icon: "üíä",
                cost: { coins: 20, apples: 0, bears: 0 },
                effect: { health: 25, happiness: -5 }
            },
            {
                id: 4,
                name: "–ö—Ä–æ–≤–∞—Ç—å",
                description: "–£–¥–æ–±–Ω–∞—è –∫—Ä–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç–¥—ã—Ö–∞",
                icon: "üõèÔ∏è",
                cost: { coins: 50, apples: 0, bears: 0 },
                effect: { energy: 30, happiness: 10 }
            },
            {
                id: 5,
                name: "–û–¥–µ–∂–¥–∞",
                description: "–°—Ç–∏–ª—å–Ω–∞—è –æ–¥–µ–∂–¥–∞ –¥–ª—è –º–∏—à–∫–∏",
                icon: "üëï",
                cost: { coins: 30, apples: 2, bears: 0 },
                effect: { happiness: 20, health: 5 }
            },
            {
                id: 6,
                name: "–í–∏—Ç–∞–º–∏–Ω—ã",
                description: "–ü–æ–ª–µ–∑–Ω—ã–µ –≤–∏—Ç–∞–º–∏–Ω—ã –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è",
                icon: "üíä",
                cost: { coins: 25, apples: 1, bears: 0 },
                effect: { health: 15, energy: 10 }
            }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            loadGameState();
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            renderGameState();
            renderUpgrades();
            renderTasks();
            renderBearShop();
            updateBearDisplay();
            
            // –ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
            setInterval(gameLoop, 1000);
            setInterval(bearLoop, 2000); // –û—Ç–¥–µ–ª—å–Ω—ã–π —Ü–∏–∫–ª –¥–ª—è –º–∏—à–∫–∏
        });
        
        function setupEventListeners() {
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    const tabName = this.getAttribute('data-tab');
                    document.querySelectorAll('[id$="-view"]').forEach(view => {
                        view.classList.add('hidden');
                    });
                    document.getElementById(`${tabName}-view`).classList.remove('hidden');
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–∞–ø–∞ –ø–æ –±–∏—Ä–∂–µ
            const exchangeBuilding = document.getElementById('exchange-building');
            exchangeBuilding.addEventListener('click', handleTap);
            
            // –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            document.getElementById('refresh-btn').addEventListener('click', function() {
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const viewName = this.getAttribute('data-view');
                    
                    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–∫–ª–∞–¥–∫—É
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ view
                    document.querySelectorAll('[id$="-view"]').forEach(view => {
                        view.classList.add('hidden');
                    });
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω–æ–µ view
                    if (viewName === 'tap') {
                        document.getElementById('tap-view').classList.remove('hidden');
                        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∫–ª–∞–¥–∫—É –¢–∞–ø–∞–ª–∫–∞
                        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                        document.querySelector('.tab[data-tab="tap"]').classList.add('active');
                    } else if (viewName === 'stocks') {
                        document.getElementById('stocks-view').classList.remove('hidden');
                    } else if (viewName === 'portfolio') {
                        document.getElementById('portfolio-view').classList.remove('hidden');
                    } else if (viewName === 'bear') {
                        document.getElementById('bear-view').classList.remove('hidden');
                        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∫–ª–∞–¥–∫—É –ú–∏—à–∫–∞
                        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                        document.querySelector('.tab[data-tab="bear"]').classList.add('active');
                    }
                });
            });
        }
        
        function handleTap(event) {
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ —Ç–∞–ø–æ–≤
            gameState.totalTaps++;
            gameState.coins += calculateTapValue();
            
            // –°–æ–∑–¥–∞–µ–º –ª–µ—Ç–∞—é—â–∏–π —Ç–µ–∫—Å—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–æ–Ω–µ—Ç
            createTapText(event, `+${calculateTapValue()}`);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –≤—ã–¥–∞—Ç—å —è–±–ª–æ–∫–æ (–∫–∞–∂–¥—ã–µ 1000 —Ç–∞–ø–æ–≤)
            if (gameState.totalTaps % 1000 === 0) {
                gameState.apples++;
                createTapText(event, 'üçé +1', 'apple');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏–π
            updateTaskProgress('tap', 1);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            saveGameState();
            renderGameState();
        }
        
        function calculateTapValue() {
            let baseValue = 1;
            
            // –£—á–∏—Ç—ã–≤–∞–µ–º —É–ª—É—á—à–µ–Ω–∏—è, —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç—å —Ç–∞–ø–∞
            upgradesData.forEach(upgrade => {
                if (upgrade.owned > 0 && upgrade.effect.tapValue) {
                    baseValue += upgrade.effect.tapValue * upgrade.owned;
                }
            });
            
            return baseValue;
        }
        
        function calculatePassiveIncome() {
            let income = 0;
            
            // –£—á–∏—Ç—ã–≤–∞–µ–º —É–ª—É—á—à–µ–Ω–∏—è, –¥–æ–±–∞–≤–ª—è—é—â–∏–µ –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥
            upgradesData.forEach(upgrade => {
                if (upgrade.owned > 0 && upgrade.effect.passiveIncome) {
                    income += upgrade.effect.passiveIncome * upgrade.owned;
                }
            });
            
            gameState.tapsPerSecond = income;
            return income;
        }
        
        function createTapText(event, text, type = 'coin') {
            const tapArea = document.querySelector('.tap-area');
            const tapText = document.createElement('div');
            tapText.className = 'tap-text';
            tapText.textContent = text;
            
            if (type === 'coin') {
                tapText.style.color = 'var(--coin)';
            } else if (type === 'apple') {
                tapText.style.color = 'var(--apple)';
            }
            
            // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Ä—è–¥–æ–º —Å –º–µ—Å—Ç–æ–º —Ç–∞–ø–∞
            const rect = tapArea.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            
            tapText.style.left = `${x}px`;
            tapText.style.top = `${y}px`;
            
            tapArea.appendChild(tapText);
            
            // –£–¥–∞–ª—è–µ–º —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                tapText.remove();
            }, 1000);
        }
        
        function gameLoop() {
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥
            const passiveIncome = calculatePassiveIncome();
            gameState.coins += passiveIncome;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            if (Date.now() - gameState.lastSave > 30000) {
                saveGameState();
                gameState.lastSave = Date.now();
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            renderGameState();
        }
        
        function bearLoop() {
            // –£–º–µ–Ω—å—à–∞–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –º–∏—à–∫–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
            const now = Date.now();
            const timePassed = (now - gameState.bear.lastUpdate) / 1000; // –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            
            // –£–º–µ–Ω—å—à–∞–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 1% –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã)
            gameState.bear.hunger = Math.max(0, gameState.bear.hunger - 0.008 * timePassed);
            gameState.bear.happiness = Math.max(0, gameState.bear.happiness - 0.005 * timePassed);
            gameState.bear.energy = Math.max(0, gameState.bear.energy - 0.006 * timePassed);
            
            // –ó–¥–æ—Ä–æ–≤—å–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
            if (gameState.bear.hunger < 30 || gameState.bear.happiness < 20) {
                gameState.bear.health = Math.max(0, gameState.bear.health - 0.01 * timePassed);
            } else if (gameState.bear.health < 100) {
                gameState.bear.health = Math.min(100, gameState.bear.health + 0.005 * timePassed);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
            gameState.bear.lastUpdate = now;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∏—à–∫–∏
            updateBearDisplay();
        }
        
        function updateBearDisplay() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –º–∏—à–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞
            let bearEmoji = "üß∏";
            let appearance = "baby";
            
            if (gameState.bear.age >= 0 && gameState.bear.age < 3) {
                bearEmoji = "üë∂";
                appearance = "baby";
            } else if (gameState.bear.age >= 3 && gameState.bear.age < 6) {
                bearEmoji = "üßí";
                appearance = "toddler";
            } else if (gameState.bear.age >= 6 && gameState.bear.age < 12) {
                bearEmoji = "üë¶";
                appearance = "child";
            } else if (gameState.bear.age >= 12 && gameState.bear.age < 18) {
                bearEmoji = "üë®";
                appearance = "teen";
            } else if (gameState.bear.age >= 18) {
                bearEmoji = "üßî";
                appearance = "adult";
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º emoji –º–∏—à–∫–∏
            document.getElementById('bear-display').textContent = bearEmoji;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('bear-name').textContent = gameState.bear.name;
            document.getElementById('bear-age').textContent = `–í–æ–∑—Ä–∞—Å—Ç: ${gameState.bear.age} –ª–µ—Ç`;
            document.getElementById('bear-hunger').textContent = `${Math.round(gameState.bear.hunger)}%`;
            document.getElementById('bear-happiness').textContent = `${Math.round(gameState.bear.happiness)}%`;
            document.getElementById('bear-health').textContent = `${Math.round(gameState.bear.health)}%`;
            document.getElementById('bear-energy').textContent = `${Math.round(gameState.bear.energy)}%`;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥
            gameState.bear.appearance = appearance;
        }
        
        function buyUpgrade(upgradeId) {
            const upgrade = upgradesData.find(u => u.id === upgradeId);
            
            if (!upgrade) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ö–≤–∞—Ç–∞–µ—Ç –ª–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
            if (gameState.coins >= upgrade.cost.coins && 
                gameState.apples >= upgrade.cost.apples && 
                gameState.bears >= upgrade.cost.bears) {
                
                // –í—ã—á–∏—Ç–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å
                gameState.coins -= upgrade.cost.coins;
                gameState.apples -= upgrade.cost.apples;
                gameState.bears -= upgrade.cost.bears;
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ —É–ª—É—á—à–µ–Ω–∏–π
                upgrade.owned++;
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è (–¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–∫—É–ø–∫–∏)
                upgrade.cost.coins = Math.round(upgrade.cost.coins * 1.5);
                if (upgrade.cost.apples > 0) {
                    upgrade.cost.apples = Math.round(upgrade.cost.apples * 1.2);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏–π
                updateTaskProgress('upgrade', 1);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                saveGameState();
                renderGameState();
                renderUpgrades();
                
                // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∞–Ω–∏–º–∞—Ü–∏—é —É—Å–ø–µ—à–Ω–æ–π –ø–æ–∫—É–ø–∫–∏
                const upgradeElement = document.getElementById(`upgrade-${upgradeId}`);
                upgradeElement.classList.add('pulse');
                setTimeout(() => {
                    upgradeElement.classList.remove('pulse');
                }, 300);
            }
        }
        
        function buyBearItem(itemId) {
            const item = bearShopItems.find(i => i.id === itemId);
            
            if (!item) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ö–≤–∞—Ç–∞–µ—Ç –ª–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
            if (gameState.coins >= item.cost.coins && 
                gameState.apples >= item.cost.apples && 
                gameState.bears >= item.cost.bears) {
                
                // –í—ã—á–∏—Ç–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å
                gameState.coins -= item.cost.coins;
                gameState.apples -= item.cost.apples;
                gameState.bears -= item.cost.bears;
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–µ–¥–º–µ—Ç–∞
                if (item.effect.hunger) gameState.bear.hunger = Math.min(100, gameState.bear.hunger + item.effect.hunger);
                if (item.effect.happiness) gameState.bear.happiness = Math.min(100, gameState.bear.happiness + item.effect.happiness);
                if (item.effect.health) gameState.bear.health = Math.min(100, gameState.bear.health + item.effect.health);
                if (item.effect.energy) gameState.bear.energy = Math.min(100, gameState.bear.energy + item.effect.energy);
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –º–∏—à–∫–∏
                const bearDisplay = document.getElementById('bear-display');
                if (item.effect.hunger) {
                    bearDisplay.classList.add('bear-eating');
                    setTimeout(() => bearDisplay.classList.remove('bear-eating'), 500);
                } else {
                    bearDisplay.classList.add('bear-happy');
                    setTimeout(() => bearDisplay.classList.remove('bear-happy'), 1000);
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                saveGameState();
                renderGameState();
                updateBearDisplay();
            }
        }
        
        function claimTaskReward(taskId) {
            const task = tasksData.find(t => t.id === taskId);
            
            if (!task || !task.completed || task.claimed) return;
            
            // –í—ã–¥–∞—ë–º –Ω–∞–≥—Ä–∞–¥—É
            gameState.coins += task.reward.coins;
            gameState.apples += task.reward.apples;
            gameState.bears += task.reward.bears;
            
            // –û—Ç–º–µ—á–∞–µ–º –∑–∞–¥–∞–Ω–∏–µ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ
            task.claimed = true;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            saveGameState();
            renderGameState();
            renderTasks();
        }
        
        function updateTaskProgress(type, amount) {
            tasksData.forEach(task => {
                if (task.claimed) return;
                
                if (type === 'tap' && task.name.includes('—Ç–∞–ø')) {
                    task.progress += amount;
                } else if (type === 'apple' && task.name.includes('—è–±–ª–æ–∫')) {
                    task.progress += amount;
                } else if (type === 'upgrade' && task.name.includes('—É–ª—É—á—à–µ–Ω–∏–π')) {
                    task.progress += amount;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ª–∏ –∑–∞–¥–∞–Ω–∏–µ
                if (task.progress >= task.goal) {
                    task.completed = true;
                }
            });
        }
        
        function renderGameState() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∞–ª—é—Ç
            document.getElementById('coins-count').textContent = Math.floor(gameState.coins);
            document.getElementById('apples-count').textContent = gameState.apples;
            document.getElementById('bears-count').textContent = gameState.bears;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('total-taps').textContent = gameState.totalTaps;
            document.getElementById('taps-per-second').textContent = gameState.tapsPerSecond.toFixed(1);
            document.getElementById('exchange-level').textContent = gameState.exchangeLevel;
        }
        
        function renderUpgrades() {
            const container = document.getElementById('upgrades-container');
            container.innerHTML = '';
            
            upgradesData.forEach(upgrade => {
                const upgradeElement = document.createElement('div');
                upgradeElement.className = 'upgrade-card';
                upgradeElement.id = `upgrade-${upgrade.id}`;
                
                upgradeElement.innerHTML = `
                    <div class="upgrade-header">
                        <div class="upgrade-icon">${upgrade.icon}</div>
                        <div class="upgrade-title">${upgrade.name}</div>
                        <div class="upgrade-owned">${upgrade.owned}</div>
                    </div>
                    <div class="upgrade-description">${upgrade.description}</div>
                    <div class="upgrade-cost">
                        ${upgrade.cost.coins > 0 ? `
                            <div class="cost-item">
                                <span class="currency-icon coin">ü™ô</span>
                                <span class="cost-amount">${upgrade.cost.coins}</span>
                            </div>
                        ` : ''}
                        ${upgrade.cost.apples > 0 ? `
                            <div class="cost-item">
                                <span class="currency-icon apple">üçé</span>
                                <span class="cost-amount">${upgrade.cost.apples}</span>
                            </div>
                        ` : ''}
                        ${upgrade.cost.bears > 0 ? `
                            <div class="cost-item">
                                <span class="currency-icon bear">üß∏</span>
                                <span class="cost-amount">${upgrade.cost.bears}</span>
                            </div>
                        ` : ''}
                    </div>
                `;
                
                upgradeElement.addEventListener('click', () => buyUpgrade(upgrade.id));
                container.appendChild(upgradeElement);
            });
        }
        
        function renderTasks() {
            const container = document.getElementById('tasks-container');
            container.innerHTML = '';
            
            tasksData.forEach(task => {
                const progressPercent = Math.min(100, (task.progress / task.goal) * 100);
                const canClaim = task.completed && !task.claimed;
                
                const taskElement = document.createElement('div');
                taskElement.className = 'task-card';
                
                taskElement.innerHTML = `
                    <div class="task-name">${task.name}</div>
                    <div class="task-description">${task.description}</div>
                    <div class="task-progress">
                        <div class="task-progress-bar" style="width: ${progressPercent}%"></div>
                    </div>
                    <div class="task-progress-text">${task.progress}/${task.goal}</div>
                    <div class="task-reward">
                        ${task.reward.coins > 0 ? `
                            <div class="cost-item">
                                <span class="currency-icon coin">ü™ô</span>
                                <span class="cost-amount">${task.reward.coins}</span>
                            </div>
                        ` : ''}
                        ${task.reward.apples > 0 ? `
                            <div class="cost-item">
                                <span class="currency-icon apple">üçé</span>
                                <span class="cost-amount">${task.reward.apples}</span>
                            </div>
                        ` : ''}
                        ${task.reward.bears > 0 ? `
                            <div class="cost-item">
                                <span class="currency-icon bear">üß∏</span>
                                <span class="cost-amount">${task.reward.bears}</span>
                            </div>
                        ` : ''}
                    </div>
                    <button class="task-claim-btn" ${canClaim ? '' : 'disabled'}>
                        ${canClaim ? '–ó–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É' : (task.claimed ? '–ù–∞–≥—Ä–∞–¥–∞ –ø–æ–ª—É—á–µ–Ω–∞' : '–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ')}
                    </button>
                `;
                
                if (canClaim) {
                    const claimBtn = taskElement.querySelector('.task-claim-btn');
                    claimBtn.addEventListener('click', () => claimTaskReward(task.id));
                }
                
                container.appendChild(taskElement);
            });
        }
        
        function renderBearShop() {
            const container = document.getElementById('bear-shop');
            container.innerHTML = '';
            
            bearShopItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'shop-item';
                itemElement.id = `bear-item-${item.id}`;
                
                itemElement.innerHTML = `
                    <div class="shop-item-icon">${item.icon}</div>
                    <div class="shop-item-name">${item.name}</div>
                    <div class="shop-item-description">${item.description}</div>
                    <div class="shop-item-cost">
                        ${item.cost.coins > 0 ? `
                            <div class="cost-item">
                                <span class="currency-icon coin">ü™ô</span>
                                <span class="cost-amount">${item.cost.coins}</span>
                            </div>
                        ` : ''}
                        ${item.cost.apples > 0 ? `
                            <div class="cost-item">
                                <span class="currency-icon apple">üçé</span>
                                <span class="cost-amount">${item.cost.apples}</span>
                            </div>
                        ` : ''}
                        ${item.cost.bears > 0 ? `
                            <div class="cost-item">
                                <span class="currency-icon bear">üß∏</span>
                                <span class="cost-amount">${item.cost.bears}</span>
                            </div>
                        ` : ''}
                    </div>
                `;
                
                itemElement.addEventListener('click', () => buyBearItem(item.id));
                container.appendChild(itemElement);
            });
        }
        
        function loadGameState() {
            const savedState = localStorage.getItem('exchangeGameState');
            if (savedState) {
                const parsedState = JSON.parse(savedState);
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                gameState.coins = parsedState.coins || 0;
                gameState.apples = parsedState.apples || 0;
                gameState.bears = parsedState.bears || 0;
                gameState.totalTaps = parsedState.totalTaps || 0;
                gameState.exchangeLevel = parsedState.exchangeLevel || 1;
                gameState.tapsPerSecond = parsedState.tapsPerSecond || 0;
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –º–∏—à–∫–∏
                if (parsedState.bear) {
                    gameState.bear = parsedState.bear;
                }
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —É–ª—É—á—à–µ–Ω–∏—è
                if (parsedState.upgrades) {
                    parsedState.upgrades.forEach(savedUpgrade => {
                        const upgrade = upgradesData.find(u => u.id === savedUpgrade.id);
                        if (upgrade) {
                            upgrade.owned = savedUpgrade.owned || 0;
                            upgrade.cost = savedUpgrade.cost || upgrade.cost;
                        }
                    });
                }
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–¥–∞–Ω–∏—è
                if (parsedState.tasks) {
                    parsedState.tasks.forEach(savedTask => {
                        const task = tasksData.find(t => t.id === savedTask.id);
                        if (task) {
                            task.progress = savedTask.progress || 0;
                            task.completed = savedTask.completed || false;
                            task.claimed = savedTask.claimed || false;
                        }
                    });
                }
            }
        }
        
        function saveGameState() {
            // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            const stateToSave = {
                coins: gameState.coins,
                apples: gameState.apples,
                bears: gameState.bears,
                totalTaps: gameState.totalTaps,
                exchangeLevel: gameState.exchangeLevel,
                tapsPerSecond: gameState.tapsPerSecond,
                bear: gameState.bear,
                upgrades: upgradesData.map(u => ({
                    id: u.id,
                    owned: u.owned,
                    cost: u.cost
                })),
                tasks: tasksData.map(t => ({
                    id: t.id,
                    progress: t.progress,
                    completed: t.completed,
                    claimed: t.claimed
                })),
                lastSave: Date.now()
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('exchangeGameState', JSON.stringify(stateToSave));
        }
    </script>
</body>
</html>